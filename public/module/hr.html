<script>
	getAllEmployees();
	
	myTabbar = mySidebar.cells(ids).attachTabbar({
		mode: "bottom",
		tabs: [
			{id: "t1", text: "210 File", active: true},
			{id: "t2", text: "Holidays"},
			{id: "t3", text: "Working Schedules"}
		]
	});

	// 201_file
	add_201 = myTabbar.tabs("t1").attachMenu({
		json: "./json/HR/hr_menu.json",
		icons_path: "./img/dhtmlxSidebar/toolbar_18/"
	});

	Grid_201 = myTabbar.tabs("t1").attachGrid();
	Grid_201.load("./json/HR/hr_grid.json", "json");
	Grid_201.setStyle("font-weight: bold;");

	Grid_201.attachEvent("onRowDblClicked", function(rowId, cell_index) {
		hr201File(rowId);
	});

	add_201.attachEvent("onClick", function(id) {
		switch(id) {
			case "201_new":
				hr201File(id);
				break;
			case "import_201":
				importRecords();
				break;
		}
	});

	//holiday
	holiday = myTabbar.tabs("t2").attachMenu({
		json: "./json/HR/holidays.json",
		icons_path: "./img/dhtmlxSidebar/toolbar_18/"
	});

	Grid_holiday = myTabbar.tabs("t2").attachGrid();
	Grid_holiday.load("./json/HR/holiday_grid.json", "json");
	Grid_holiday.setStyle("font-weight: bold;");

	holiday.attachEvent("onClick", function(id) {
		switch(id) {
			case "add_holiday":
				addHoliday();
				break;
			case "import_holiday":
				importHolidays();
				break;
		}
	});

	//working_sched
	scheduler.config.first_hour = 6;
	scheduler.config.last_hour = 20;
	scheduler.config.details_on_create = true;
	scheduler.config.details_on_dblclick = true;
	scheduler.config.repeat_date = "%m/%d/%Y";

	scheduler.config.xml_date="%Y-%m-%d %H:%i";
	scheduler.config.prevent_cache = true;

	scheduler.config.occurrence_timestamp_in_utc = true;
	scheduler.config.include_end_by = true;
	scheduler.config.repeat_precise = true;

	sched = myTabbar.tabs("t3").attachScheduler(new Date(), "week");

	sched.addEvent({
		start_date: "14-07-2015 08:00",
		end_date: "14-07-2015 12:00",
		text: "Work"
	});

	sched.addEvent({
		start_date: "14-07-2015 13:00",
		end_date: "14-07-2015 18:00",
		text: "Work"
	});

	function hr201File(id)
	{
		dhxWins = new dhtmlXWindows();
		w1 = dhxWins.createWindow({
			id: "w1",
			width: 810,
			height: 479,
			move: false,
			center: true,
			resize: false,
			caption: 'Add New 201 File'
		});
		w1.button("minmax").hide();
		w1.setModal(true);

		myTabbar = w1.attachTabbar({
			mode: "bottom",
			tabs: [
				{id: "t1", text: "Basic Information", active: true},
				{id: "t2", text: "Contact Details"},
				{id: "t3", text: "Employment Details"},
				{id: "t4", text: "Goverment Details"},
				{id: "t5", text: "School and Work History"},
				{id: "t6", text: "Working Schedule"},
			]
		});

		formData = [
			{ type: "fieldset", label: "Basic Information", list: [
			{ type:"block", width: 743, list: [
				{type: "label", offsetLeft: 180, label: "<img src='./img/64x64-logo.png' />"},
				{ type: "newcolumn" },
				{type: "upload", name: "myFiles", inputWidth: 330, url: "php/dhtmlxform_item_upload.php", _swfLogs: "enabled", swfPath: "uploader.swf", swfUrl: "php/dhtmlxform_item_upload.php"},
			]},
			{ type:"block", width: 743, list: [
				{type: "input", name: "employee_id", label: "Employee No.", inputWidth: 300, position: "label-top", required:true, validate:"NotEmpty"},
				{ type: "newcolumn" },
				{type: "input", name: "Fname", offsetLeft: 85, label: "First Name", inputWidth: 300, position: "label-top", required:true, validate:"NotEmpty"},
			]},
			{ type:"block", width: 743, list: [
				{type: "input", name: "Lname", label: "Last Name", inputWidth: 300, position: "label-top", required:true, validate:"NotEmpty"},
				{ type: "newcolumn" },
				{type: "input", name: "Mname", offsetLeft: 85, label: "Middle Name", inputWidth: 300, position: "label-top"},
			]},
			{ type:"block", width: 743, list: [
				{type: "calendar", name: "birthdate", label: "Birthdate", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "input", name: "gender", offsetLeft: 85, label: "Gender", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "select", name: "marital_status", label: "Marital Status", inputWidth: 300, position: "label-top", options:[
						{text: "Single", value: "single", name: "single", selected: true},
						{text: "Married", value: "married", name: "married"},
				]},
				{ type: "newcolumn" },
				{type: "select", name: "active", offsetLeft: 90, label: "Active", inputWidth: 300, position: "label-top", options:[
						{text: "Yes", value: "yes", name: "yes", selected: true},
						{text: "No", value: "no", name: "no"},
				]},
			]},
				{ type: "button", value: "Submit", name: "basic_button", className: "btnSub"},
				{ type: "button", value: "Update", name: "basic_update", className: "btnSub"}
			]}, //end basic information
			
		];

		contact_details = [
			{ type: "fieldset", label: "Contact Details", list: [
			{ type:"block", width: 743, list: [
				{type: "input", name: "email", label: "Email", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "input", name: "phone_no", offsetLeft: 85, label: "Phone No.", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "input", name: "mobile_no", label: "Mobile No.", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "input", name: "address1", offsetLeft: 85, label: "Address Line 1", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "input", name: "address2", label: "Address Line 2", inputWidth: 302, position: "label-top" },
				{ type: "newcolumn" },
				{type: "select", name: "city", offsetLeft: 85, label: "City", inputWidth: 302, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "select", name: "province", label: "Province", inputWidth: 302, position: "label-top" },
				{ type: "newcolumn" },
				{type: "select", name: "country", offsetLeft: 88, label: "Country", inputWidth: 302, position: "label-top" }
			]},
				{ type: "button", value: "Submit", className: "btnSub" }
			]},// end Contact details
		];

		employment_details = [
			{ type: "fieldset", label: "Employment Details", list: [
			{ type:"block", width: 743, list: [
				{type: "select", name: "employment_type", label: "Employment Type", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "select", name: "department", offsetLeft: 85, label: "Department", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "select", name: "position", label: "Position", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "select", name: "rank", offsetLeft: 85, label: "Rank", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "calendar", name: "date_hired", label: "Date Hired", inputWidth: 302, position: "label-top" },
				{ type: "newcolumn" },
				{type: "calendar", name: "date_ended", offsetLeft: 80, label: "Date Ended", inputWidth: 302, position: "label-top" }
			]},
				{ type: "button", value: "Submit", className: "btnSub" }
			]},// end Employment details
			
		];

		government_details = [
			{ type: "fieldset", label: "Government Details", list: [
			{ type:"block", width: 743, list: [
				{type: "input", name: "sss_no", label: "SSS Number", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "input", name: "bir_no", offsetLeft: 85, label: "BIR Number", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "input", name: "taxID", label: "Tax Identification No.", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "input", name: "philheath_no", offsetLeft: 85, label: "Philhealth Number", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "input", name: "hdmf_no", label: "HDMF Number", inputWidth: 300, position: "label-top" }
			]},
				{ type: "button", value: "Submit", className: "btnSub" }
			]}, // end government fieldset
		];

		school_work = [
			{ type: "fieldset", label: "School & Work History", list: [
			{ type:"block", width: 743, list: [
				{type: "input", name: "ETD", label: "Education/Transcripts/Diplomas", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "input", name: "PA", offsetLeft: 85, label: "Performance Assessments", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "input", name: "clearance", label: "Clearances", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "input", name: "correct_action", offsetLeft: 85, label: "Corrective actions", inputWidth: 300, position: "label-top" },
			]},
			{ type:"block", width: 743, list: [
				{type: "input", name: "work_history", label: "Work History", inputWidth: 300, position: "label-top" },
				{ type: "newcolumn" },
				{type: "input", name: "PEI", offsetLeft: 85, label: "Post Employment Information", inputWidth: 300, position: "label-top" },
			]},
				{ type: "button", value: "Submit", className: "btnSub" }
			]}, // end school & work fieldset
		];

		scheduler.config.first_hour = 6;
		scheduler.config.last_hour = 20;
		scheduler.config.details_on_create = true;
		scheduler.config.details_on_dblclick = true;
		scheduler.config.repeat_date = "%m/%d/%Y";

		scheduler.config.xml_date="%Y-%m-%d %H:%i";
		scheduler.config.prevent_cache = true;

		scheduler.config.occurrence_timestamp_in_utc = true;
		scheduler.config.include_end_by = true;
		scheduler.config.repeat_precise = true;

		saveBasic = myTabbar.tabs("t1").attachForm(formData, true);
		myTabbar.tabs("t2").attachForm(contact_details, true);
		myTabbar.tabs("t3").attachForm(employment_details, true);
		myTabbar.tabs("t4").attachForm(government_details, true);
		myTabbar.tabs("t5").attachForm(school_work, true);
		myTabbar.tabs("t6").attachScheduler(new Date(), "week");

		switch(id) {
			case "201_new":
				saveBasic.hideItem("basic_update");
				break;
			default:
				saveBasic.hideItem("basic_button");
				w1.setText("Edit 201 File");
				break;		
		}

		saveBasic.attachEvent('onButtonClick', function(id) {
			switch(id) {
				case "basic_button":
					saveBasicInformation();
					break;
			}
		});
	}

	function addHoliday()
	{
		dhxWins = new dhtmlXWindows();
		w1 = dhxWins.createWindow({
			id: "w1",
			width: 415,
			height: 230,
			move: false,
			center: true,
			resize: false,
			caption: 'Add New Holiday'
		});
		w1.button("minmax").hide();
		w1.setModal(true);

		formData = [
			{type: "settings", position: "label-left", labelWidth: 100, inputWidth: 250},
			{type: "block", inputWidth: "auto", offsetTop: 20, list: [
				{type: "select", label: "Holiday Type", name: "payroll_group", value: "", offsetTop: 10, options:[
						{text: "Non-Holiday", value: "non-holiday", name: "reg", selected: true},
						{text: "Regular Holiday", value: "reg_holiday", name: "group1"},
						{text: "Special Holiday", value: "spec_holiday", name: "group1"},
				]},
				{type: "input", label: "Name", name: "holiday_name", offsetTop: 10, inputWidth: 245},
				{type: "calendar", label: "Date", name: "holiday_date", offsetTop: 10, inputWidth: 245},
				{type: "button", value: "Save", name: "save", offsetLeft: 283, offsetTop: 15}
			]},
		];
		w1.attachForm(formData, true);
	}

	function importRecords()
	{
		dhxWins = new dhtmlXWindows();
			w1 = dhxWins.createWindow({
			id: "w1",
			width: 410,
			height: 180,
			move: false,
			center: true,
			resize: false,
			caption: 'Import 201 File Record'
		});
		w1.button("minmax").hide();
		w1.setModal(true);

		formData = [
			{type: "settings", position: "label-left", labelWidth: 100, inputWidth: 250},
			{type: "block", inputWidth: "auto", offsetTop: 20, list: [
				{type: "file", label: "Import File", name: "date_from", offsetTop: 10},
				{type: "button", value: "Import", name: "import", offsetLeft: 262, offsetTop: 15}
			]}
		];

		myForm = w1.attachForm(formData, true);
	}

	function importHolidays()
	{
		dhxWins = new dhtmlXWindows();
			w1 = dhxWins.createWindow({
			id: "w1",
			width: 410,
			height: 180,
			move: false,
			center: true,
			resize: false,
			caption: 'Import Holidays'
		});
		w1.button("minmax").hide();
		w1.setModal(true);

		formData = [
			{type: "settings", position: "label-left", labelWidth: 100, inputWidth: 250},
			{type: "block", inputWidth: "auto", offsetTop: 20, list: [
				{type: "file", label: "Import File", name: "date_from", offsetTop: 10},
				{type: "button", value: "Import", name: "import", offsetLeft: 262, offsetTop: 15}
			]}
		];

		myForm = w1.attachForm(formData, true);
	}

	function getAllEmployees()
	{
		$.ajax({
			type: "GET",
			headers: {
				"Accept": "application/json",
				"Content-Type": "application/json",
				"Content-Type" : "application/x-www-form-urlencoded; charset=UTF-8",
				"Authorization": "Bearer " + window.token,
			},
			url: baseUrl + "/employees",
			data: {
				
			},
			dataType: "json",
			success: function(response)
			{
				console.log(response);	
			},
			error: function(jqXHR)
			{
				console.log(jqXHR);
			}
		});
	}

	function saveBasicInformation()
	{
		var empid = $("input[name='employee_id']").val();
		var first_name = $("input[name='Fname']").val();
		var last_name = $("input[name='Lname']").val();
		// var middle_name = $("input[name='Mname']").val();
		// var birthdate = $("input[name='birthdate']").val();
		// var gender = $("input[name=gender]").val();
		// var marital_status = $("input[name=marital_status]").val();
		// var active = $("input[name=active]").val();

		$.ajax({
			type: "POST",
			headers: {
				"Accept": "application/json",
				"Content-Type": "application/problem+json",
				"Content-Type" : "application/x-www-form-urlencoded",
				"Authorization": "Bearer " + window.token,
			},
			url: baseUrl + "/employees",
			data: {
			"employee_id": 2,
			"first_name": "Raymart",
			"last_name": "Obeso"
			},
			dataType: "json",
			beforeSend: function(data)
			{
				console.log(data);
			},
			success: function(response)
			{
				console.log(response);
			},
			error: function(jqXHR)
			{
				console.log(jqXHR);
			}
		});
	}
</script>